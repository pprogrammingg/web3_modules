<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Module Tests</title>
    <link rel="stylesheet" href="shared/styles.css">
</head>
<body>
    <nav class="site-home-bar">
        <a href="index.html" class="site-home-link" aria-label="Home">üè† Home</a>
    </nav>
    <div class="course-content">
        <h1>üß™ Course Module Tests</h1>
        <p>Checks that each module loads and includes shared CSS and JS.</p>
        <button class="btn btn-primary" onclick="runTests()">Run All Tests</button>
        <div id="results"></div>
    </div>
    <script src="shared/course-data.js"></script>
    <script src="shared/navigation.js"></script>
    <script>
        function getAvailableModules() {
            const list = [];
            for (const level of ['basic', 'intermediate', 'advanced']) {
                const mods = COURSE_DATA.levels[level]?.modules ?? [];
                mods.forEach(m => { if (isModuleAvailable(m.id)) list.push({ id: m.id, path: m.path }); });
            }
            return list;
        }
        async function runTests() {
            const MODULES = getAvailableModules();
            const results = document.getElementById('results');
            results.innerHTML = '<div class="test-wrap"><h2>Running tests...</h2></div>';
            let passed = 0, total = 0;
            for (const module of MODULES) {
                total++;
                try {
                    const res = await fetch(module.path);
                    const html = await res.text();
                    const hasCSS = html.includes('styles.css');
                    const hasJS = html.includes('course-data.js') && html.includes('navigation.js');
                    if (res.ok && hasCSS && hasJS) {
                        passed++;
                        results.innerHTML += `<div class="test-wrap"><div class="test-pass">‚úÖ ${module.id}: All checks passed</div></div>`;
                    } else {
                        results.innerHTML += `<div class="test-wrap"><div class="test-fail">‚ùå ${module.id}: ${!res.ok ? 'Fetch failed' : ''} ${!hasCSS ? 'Missing CSS ' : ''}${!hasJS ? 'Missing JS' : ''}</div></div>`;
                    }
                } catch (e) {
                    results.innerHTML += `<div class="test-wrap"><div class="test-fail">‚ùå ${module.id}: ${e.message}</div></div>`;
                }
            }
            results.innerHTML += `<div class="test-wrap test-summary">Summary: ${passed}/${total} passed</div>`;
        }
        document.querySelector('.btn-primary').addEventListener('click', runTests);
        window.addEventListener('load', () => setTimeout(runTests, 500));
    </script>
</body>
</html>
